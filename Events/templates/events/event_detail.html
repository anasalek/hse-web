{% extends 'events/base.html' %}

{% block title %}{{ event.name }} - Мероприятие{% endblock %}

{% block content %}
<div class="event_detail">
    <h1>{{ event.name }}</h1>

    <!-- БЛОК ДЛЯ СООБЩЕНИЙ -->
    {% if messages %}
    <div class="messages">
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }}">
            {{ message }}
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <div class="event_description">
        <h2>Описание мероприятия:</h2>
        <p>{{ event.description|linebreaks }}</p>
    </div>

    <div class="event_organizer">
        <p><strong>Организатор:</strong> {{ event.organizer.get_full_name|default:event.organizer.username }}</p>
    </div>

    {% if user.is_authenticated %}
        <form method="post" action="{% url 'event_participate' id=event.id %}">
            {% csrf_token %}
            <button
                type="submit"
                class="btn btn-primary"
                {% if user_is_participating %}disabled{% endif %}
            >
                {% if user_is_participating %}Вы уже записаны{% else %}Записаться{% endif %}
            </button>
        </form>
        {% if user_is_participating %}
            <p class="participation-info">Вы уже записаны на это мероприятие.</p>
        {% endif %}
    {% else %}
        <p><a href="{% url 'login' %}">Войдите</a>, чтобы записаться.</p>
    {% endif %}

</div>
{% endblock %}